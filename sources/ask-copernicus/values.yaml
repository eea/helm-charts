image:
  repository: eeacms/ask-copernicus-frontend
  pullPolicy: Always
  tag: "3.404.0"

imagePullSecrets: []

nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: false
  annotations: {}
  name: ""

timezone: Europe/Copenhagen

links:
  backend: backend.ask-copernicus

ingress:
  annotations:
    cert-manager.io/cluster-issuer: 01dev-eea-letsencrypt
    nginx.ingress.kubernetes.io/configuration-snippet: |-
      more_set_headers 'Server HTTPS'
        'Strict-Transport-Security max-age=31536000; includeSubDomains; preload'
        "Expect-CT max-age=604800, report-uri='https://sentry.eea.europa.eu/api/45/security/?sentry_key=0343e20fc4e0469790b6016561f032e3'"
        'X-Content-Type-Options nosniff'
        'X-XSS-Protection "1; mode=block"'
        "X-Frame-Options 'SAMEORIGIN'"
        "Referrer-Policy origin"
        'Permissions-Policy accelerometer=(), autoplay=(), camera=(), encrypted-media=(), fullscreen=(self), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), midi=(), payment=(), picture-in-picture=(), sync-xhr=(self), usb=()';
    nginx.ingress.kubernetes.io/proxy-body-size: 1024m
    nginx.ingress.kubernetes.io/proxy-read-timeout: '480'
    nginx.ingress.kubernetes.io/proxy-send-timeout: '120'
  certificate: ask.copernicus.01dev.eea.europa.eu-tls
  tls: enabled

ingressredirects:
  - enabled: false
    tls: true
    certificate: www.plone.eea.europa.eu-tls
    annotations:
      cert-manager.io/cluster-issuer: 01dev-eea-letsencrypt
    hostname: www.plone.eea.europa.eu

links:
  backend: backend-varnish.ied

volto:
  serviceType: ClusterIP
  hostname: ask.copernicus.01dev.eea.europa.eu
  replicaCount: 1
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 4
    targetCPUUtilizationPercentage: 80
  resources:
    limits:
      memory: 2Gi
    requests:
      memory: 2Gi
  environment:
    INTERNAL_API_PATH: http://backend:8080/VirtualHostBase/https/ask.copernicus.eu:443/Plone/VirtualHostRoot/ask-copernicus
    RAZZLE_INTERNAL_API_PATH: http://backend:8080/VirtualHostBase/https/ask.copernicus.eu:443/Plone/VirtualHostRoot/ask-copernicus
    RAZZLE_API_PATH: https://ask.copernicus.eu
    RAZZLE_PUBLIC_PATH: /
    RAZZLE_BACKEND_NAME: 'eea.docker.plone.clms'
    RAZZLE_IS_ASK_COPERNICUS: "1"
    DEBUG: superagent
    RAZZLE_SENTRY_DSN: ""
    RAZZLE_SENTRY_RELEASE: ""
    RAZZLE_SENTRY_ENVIRONMENT: 01dev
    SENTRY_URL: https://sentry.eea.europa.eu
    SENTRY_AUTH_TOKEN: ""
    SENTRY_ORG: eea
    SENTRY_PROJECT: ask-copernicus-eu
    RAZZLE_MATOMO_SITE_ID: ""
    DANSWER_URL: ""
    DANSWER_API_KEY: ""
    DANSWER_PASSWORD: ""
    DANSWER_USERNAME: ""
    CSP_HEADER: >-
      default-src 'none';
      base-uri 'self';
      form-action 'self';
      object-src 'none';
      manifest-src 'self'
      media-src https://ask.copernicus.eu/;
      connect-src 'self' https://webanalytics.europa.eu https://*.eea.europa.eu https://europa.eu https://geocode.arcgis.com https://api.openaire.eu https://api.zotero.org;
      font-src 'self' data: https://cdnjs.cloudflare.com https://fonts.gstatic.com https://*.eea.europa.eu;
      frame-src 'self' https://europa.eu https://*.europa.eu https://*.eea.europa.eu https://eea.maps.arcgis.com;
      img-src https: blob: data:;
      script-src 'self' {nonce} blob: https://webanalytics.europa.eu https://matomo.eea.europa.eu https://europa.eu https://www.google.com https://www.gstatic.com https://spreadsheets.google.com https://docs.google.com https://*.eea.europa.eu https://d3js.org https://cdnjs.cloudflare.com https://code.jquery.com https://services.arcgis.com https://public.tableau.com;
      style-src 'self' 'unsafe-inline'  https://www.google.com https://europa.eu https://fonts.googleapis.com https://ajax.googleapis.com https://www.gstatic.com https://*.eea.europa.eu https://cdnjs.cloudflare.com https://code.jquery.com;
      frame-ancestors 'self' https://*.eea.europa.eu;
      report-to csp-endpoint;
      report-uri https://sentry.eea.europa.eu/api/45/security/?sentry_key=0343e20fc4e0469790b6016561f032e3;
  annotations: {}
  livenessProbe:
    httpGet:
      path: /ok
      port: http
    periodSeconds: 10
    timeoutSeconds: 10
    initialDelaySeconds: 30
    failureThreshold: 5
    successThreshold: 1
  startupProbe:
    httpGet:
      path: /ok
      port: http
    periodSeconds: 5
    timeoutSeconds: 10
    initialDelaySeconds: 10
    failureThreshold: 12
    successThreshold: 1

service:
  type: ClusterIP
  port: 3000

varnish:
  serviceType: ClusterIP
  serviceName: frontend-varnish
  port: 3000
  backend: "frontend-volto"
  resources:
    limits:
      memory: 2Gi
    requests:
      memory: 2Gi
  nodeSelector: {}
  tolerations: []

affinity: {}

debug:
  serviceType: ClusterIP
  enabled: false
  resources:
    limits:
      memory: 4Gi
    requests:
      memory: 4Gi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  podAnnotations: {}
  podSecurityContext: {}
  securityContext: {}
  environment: {}
  environment:
    VARNISH_SIZE: '2G'
    VARNISH_DNS_TTL: '20s'
    VARNISH_BERESP_TTL: '60s' 
    VARNISH_BERESP_GRACE: '120s'
    VARNISH_BERESP_KEEP: '120s'
    VARNISH_GZIP_ENABLED: 'false'
    VARNISH_GZIP_JSON_ENABLED: 'false' 
    AUTOKILL_CRON: ''
  livenessProbe:
    httpGet:
      path: /ok
      port: http
    periodSeconds: 10
    timeoutSeconds: 10
    initialDelaySeconds: 30
    failureThreshold: 5
    successThreshold: 1
  startupProbe:
    httpGet:
      path: /ok
      port: http
    periodSeconds: 5
    timeoutSeconds: 10
    initialDelaySeconds: 10
    failureThreshold: 12
    successThreshold: 1

resources: {}

nodeSelector: {}

tolerations: []

affinity: {}
